<!DOCTYPE html>
<html lang="zh">
<head>
    <title>易混淆数 II</title>
    <link rel="shortcut icon" href="/static/favicon.ico">
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/detail.css">
    <link rel="stylesheet" href="/static/css/github.css">
    <style>
        body {
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .container-fluid {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        main {
            flex-grow: 1;
        }
        .code-pre {
             white-space: pre-wrap;
             word-wrap: break-word;
        }
    </style>
</head>
<body>
    <div class="container-fluid mt-3">
        <header class="d-flex flex-column flex-md-row justify-content-md-between align-items-md-center mb-3">
            <a href="/problems" class="btn btn-secondary mb-2 mb-md-0">返回题目列表</a>
            <div class="text-md-end">
                <strong class="me-md-3 d-block d-md-inline mb-2 mb-md-0">易混淆数 II</strong>
                标签:
                
                    <a href="/problems?tag=math" class="badge bg-secondary tag-link">数学</a>
                
                    <a href="/problems?tag=backtracking" class="badge bg-secondary tag-link">回溯</a>
                
                &nbsp;&nbsp;
                难度: <span class="badge bg-secondary">Hard</span>
            </div>
        </header>

        <main>
            <section class="mb-4">
                <h2>Submission</h2>
                <div class="code-block">
                    <pre class="bg-light p-2 code-pre"><code class="language-python">class Solution:
    def confusingNumberIII(self, n: int) -&gt; int:
        ret = 0
        for i in range(1, n + 1):
            s = str(i)
            if &#39;2&#39; in s:
                continue
            if &#39;3&#39; in s:
                continue
            if &#39;4&#39; in s:
                continue
            if &#39;5&#39; in s:
                continue
            if &#39;7&#39; in s:
                continue
            s = s.replace(&#39;6&#39;, &#39;z&#39;)
            s = s.replace(&#39;9&#39;, &#39;6&#39;)
            s = s.replace(&#39;z&#39;, &#39;9&#39;)
            s = s[::-1]
            if s != str(i):
                ret += 1
        return ret
    def confusingNumberII(self, n: int) -&gt; int:
        invalid = 0
        try:
            for l in range(1, len(str(n)) + 1):
                hl = (l + 1) // 2
                for i in product(&#39;01689&#39;, repeat=hl):
                    if i[0] == &#39;0&#39;:
                        continue
                    if i[-1] == &#39;6&#39; or i[-1] == &#39;9&#39;:
                        if l % 2:
                            continue
                    i = &#39;&#39;.join(i)
                    if l % 2:
                        s = i + i[:-1][::-1].replace(&#39;6&#39;, &#39;a&#39;).replace(&#39;9&#39;, &#39;6&#39;).replace(&#39;a&#39;, &#39;9&#39;)
                    else:
                        s = i + i[::-1].replace(&#39;6&#39;, &#39;a&#39;).replace(&#39;9&#39;, &#39;6&#39;).replace(&#39;a&#39;, &#39;9&#39;)
                    if int(s) &gt;n:
                        raise ValueError()
                    invalid += 1
        except ValueError:
            pass
        x = []
        flag = False
        for c in str(n):
            if flag:
                x.append(&#39;9&#39;)
            else:
                if c in &#39;01689&#39;:
                    x.append(c)
                else:
                    x.append({&#39;7&#39;:&#39;6&#39;, &#39;5&#39;:&#39;1&#39;, &#39;4&#39;:&#39;1&#39;, &#39;3&#39;:&#39;1&#39;, &#39;2&#39;:&#39;1&#39;,}[c])
                    flag = True
        x = &#39;&#39;.join(x)
        x = x.replace(&#39;6&#39;, &#39;2&#39;).replace(&#39;8&#39;, &#39;3&#39;).replace(&#39;9&#39;, &#39;4&#39;)
        x = int(x, 5)
        #print(x, invalid)

        return x - invalid
                </code></pre>
                    <button class="btn btn-sm btn-secondary copy-btn" onclick="copyCode(this)">复制代码</button>
                    <p class="mt-2 mb-0">运行时间: 47 ms</p>
                    <p class="mb-0">内存: 16.1 MB</p>
                </div>
            </section>

            
                <section>
                    <h2>Explain</h2>
                    <div>
                        <p>这道题目要求找到不超过给定数字 n 的所有&#39;易混淆数&#39;的数量。&#39;易混淆数&#39;是指当一个数字旋转 180 度后，形成一个不同的有效数字。题解中定义了两个方法：confusingNumberIII 和 confusingNumberII。

confusingNumberIII 方法遍历从 1 到 n 的所有数字，首先将包含不可翻转的数字（2, 3, 4, 5, 7）的数字排除。然后，将剩余的数字进行转换：6 和 9 互换，最后将数字翻转。如果翻转后的数字与原数字不同，则是一个易混淆数。

confusingNumberII 方法使用了一种生成方法来直接构造可能的易混淆数，并且计算它们的数量。通过固定数字的一半长度，然后生成所有可能的组合，并将它们翻转拼接来形成完整的数字。然后根据生成的数字是否有效和是否大于 n 来决定是否停止。这种方法更有效地使用了数位的特性来直接计算易混淆数的数量。</p>
                        <p>时间复杂度: confusingNumberIII: O(n * k), confusingNumberII: O(5^L)</p>
                        <p>空间复杂度: confusingNumberIII: O(k), confusingNumberII: O(L)</p>
                        
                             <pre class="bg-light p-2 code-pre"><code class="language-python">class Solution:
    def confusingNumberIII(self, n: int) -&gt; int:
        ret = 0
        for i in range(1, n + 1):
            s = str(i)
            # 排除含有2,3,4,5,7的数字
            if any(c in s for c in &#39;23457&#39;):
                continue
            # 6和9互换
            s = s.replace(&#39;6&#39;, &#39;z&#39;).replace(&#39;9&#39;, &#39;6&#39;).replace(&#39;z&#39;, &#39;9&#39;)
            # 反转字符串
            s = s[::-1]
            # 检查翻转后是否与原字符串不同
            if s != str(i):
                ret += 1
        return ret
    def confusingNumberII(self, n: int) -&gt; int:
        invalid = 0
        try:
            for l in range(1, len(str(n)) + 1):
                hl = (l + 1) // 2
                # 生成长度为 hl 的数字串
                for i in product(&#39;01689&#39;, repeat=hl):
                    if i[0] == &#39;0&#39;:
                        continue
                    if i[-1] == &#39;6&#39; or i[-1] == &#39;9&#39;:
                        if l % 2:
                            continue
                    i = &#39;&#39;.join(i)
                    # 根据是否是中间数字调整生成策略
                    if l % 2:
                        s = i + i[:-1][::-1].replace(&#39;6&#39;, &#39;a&#39;).replace(&#39;9&#39;, &#39;6&#39;).replace(&#39;a&#39;, &#39;9&#39;)
                    else:
                        s = i + i[::-1].replace(&#39;6&#39;, &#39;a&#39;).replace(&#39;9&#39;, &#39;6&#39;).replace(&#39;a&#39;, &#39;9&#39;)
                    # 如果生成的数字超过 n，停止
                    if int(s) &gt; n:
                        raise ValueError()
                    invalid += 1
        except ValueError:
            pass
        x = []
        flag = False
        for c in str(n):
            if flag:
                x.append(&#39;9&#39;)
            else:
                if c in &#39;01689&#39;:
                    x.append(c)
                else:
                    x.append({&#39;7&#39;:&#39;6&#39;, &#39;5&#39;:&#39;1&#39;, &#39;4&#39;:&#39;1&#39;, &#39;3&#39;:&#39;1&#39;, &#39;2&#39;:&#39;1&#39;,}[c])
                    flag = True
        x = &#39;&#39;.join(x)
        # 使用不同的替换策略来减少无效数的影响
        x = x.replace(&#39;6&#39;, &#39;2&#39;).replace(&#39;8&#39;, &#39;3&#39;).replace(&#39;9&#39;, &#39;4&#39;)
        x = int(x, 5)
        #print(x, invalid)

        return x - invalid
</code></pre>
                        
                    </div>
                </section>
            
        </main>
    </div>
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.bundle.min.js"></script>
    <script src="/static/js/highlight.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const copyButtons = document.querySelectorAll('.copy-btn');
            copyButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    copyCode(this);
                });
            });
            hljs.highlightAll();
        });

        function copyCode(button) {
            const codeBlock = button.previousElementSibling;
            const code = codeBlock.textContent;
            navigator.clipboard.writeText(code).then(function() {
                button.textContent = '已复制';
                setTimeout(function() {
                    button.textContent = '复制代码';
                }, 2000);
            }, function(err) {
                console.error('无法复制代码: ', err);
            });
        }
    </script>
</body>
</html>