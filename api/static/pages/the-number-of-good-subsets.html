<!DOCTYPE html>
<html lang="zh">
<head>
    <title>好子集的数目</title>
    <link rel="shortcut icon" href="/static/favicon.ico">
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/detail.css">
    <link rel="stylesheet" href="/static/css/github.css">
    <style>
        body {
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .container-fluid {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        main {
            flex-grow: 1;
        }
        .code-pre {
             white-space: pre-wrap;
             word-wrap: break-word;
        }
    </style>
</head>
<body>
    <div class="container-fluid mt-3">
        <header class="d-flex flex-column flex-md-row justify-content-md-between align-items-md-center mb-3">
            <a href="/problems" class="btn btn-secondary mb-2 mb-md-0">返回题目列表</a>
            <div class="text-md-end">
                <strong class="me-md-3 d-block d-md-inline mb-2 mb-md-0">好子集的数目</strong>
                标签:
                
                    <a href="/problems?tag=bit-manipulation" class="badge bg-secondary tag-link">位运算</a>
                
                    <a href="/problems?tag=array" class="badge bg-secondary tag-link">数组</a>
                
                    <a href="/problems?tag=math" class="badge bg-secondary tag-link">数学</a>
                
                    <a href="/problems?tag=dynamic-programming" class="badge bg-secondary tag-link">动态规划</a>
                
                    <a href="/problems?tag=bitmask" class="badge bg-secondary tag-link">状态压缩</a>
                
                &nbsp;&nbsp;
                难度: <span class="badge bg-secondary">Hard</span>
            </div>
        </header>

        <main>
            <section class="mb-4">
                <h2>Submission</h2>
                <div class="code-block">
                    <pre class="bg-light p-2 code-pre"><code class="language-python">class Solution:
    def numberOfGoodSubsets(self, nums: List[int]) -&gt; int:
        pri=[2,3,5,7,11,13,17,19,23,29]                
        dic=Counter(nums)
        #情况1只含质数
        cnt1=1
        for i in pri:
            cnt1*=(dic[i]+1)
        ans=cnt1-1
        #print(ans)
        def ct(a,b):
            cnt2=1
            for i in pri:
                if i!=a and i!=b:
                    cnt2*=(dic[i]+1)            
            return cnt2*dic[a*b]
        #情况2:一个合数 [6,10,14,15,21,22,26,30]  
        ans+=ct(2,3)+ct(2,5)+ct(2,7)+ct(3,5)+ct(3,7)+ct(2,11)+ct(2,13)
        #有30单独算
        cnt2=1
        for i in pri:
            if i!=2 and i!=3 and i!=5:
                cnt2*=(dic[i]+1)
        ans+=cnt2*dic[30] 
        #情况3:两个合数 [15,14][15,22][15,26][21,10][21,22][21,26]
        def cth(a,b,c,d):
            cnt3=1
            for i in pri:
                if i!=a and i!=b and i!=c and i!=d:
                    cnt3*=(dic[i]+1)            
            return cnt3*dic[a*b]*dic[c*d]
        
        ans+=cth(3,5,2,7)+cth(3,5,2,11)+cth(3,5,2,13)+cth(3,7,2,5)+cth(3,7,2,11)+cth(3,7,2,13)
        
        return (ans*(2**dic[1]))%(10**9+7)
</code></pre>
                    <button class="btn btn-sm btn-secondary copy-btn" onclick="copyCode(this)">复制代码</button>
                    <p class="mt-2 mb-0">运行时间: 120 ms</p>
                    <p class="mb-0">内存: 21.2 MB</p>
                </div>
            </section>

            
                <section>
                    <h2>Explain</h2>
                    <div>
                        <p>此题解通过考虑不同类型的子集并分情况处理来计算好子集的数目。主要分为三类情况：1.只包含质数的子集；2.包含一个合数的子集；3.包含两个合数的子集。对于每种情况，分别计算可能的子集数量并求和。此外，1的存在对子集的组合方式有特殊影响，因为任何数量的1都可以添加到子集中而不改变乘积的质数组成，因此最后的结果需要乘上2的1的个数次幂。</p>
                        <p>时间复杂度: O(1)</p>
                        <p>空间复杂度: O(1)</p>
                        
                             <pre class="bg-light p-2 code-pre"><code class="language-python">class Solution:
    def numberOfGoodSubsets(self, nums: List[int]) -&gt; int:
        pri=[2,3,5,7,11,13,17,19,23,29]                # 定义质数列表
        dic=Counter(nums)  # 计算nums中每个数字的出现次数
        # 情况1: 只含质数
        cnt1=1
        for i in pri:
            cnt1*=(dic[i]+1)
        ans=cnt1-1  # 计算只包含质数的子集数目
        # 情况2: 包含一个合数
        def ct(a,b):
            cnt2=1
            for i in pri:
                if i!=a and i!=b:
                    cnt2*=(dic[i]+1)
            return cnt2*dic[a*b]
        ans+=ct(2,3)+ct(2,5)+ct(2,7)+ct(3,5)+ct(3,7)+ct(2,11)+ct(2,13)
        # 特殊情况: 包含数字30
        cnt2=1
        for i in pri:
            if i!=2 and i!=3 and i!=5:
                cnt2*=(dic[i]+1)
        ans+=cnt2*dic[30] 
        # 情况3: 包含两个合数
        def cth(a,b,c,d):
            cnt3=1
            for i in pri:
                if i!=a and i!=b and i!=c and i!=d:
                    cnt3*=(dic[i]+1)
            return cnt3*dic[a*b]*dic[c*d]
        ans+=cth(3,5,2,7)+cth(3,5,2,11)+cth(3,5,2,13)+cth(3,7,2,5)+cth(3,7,2,11)+cth(3,7,2,13)
        # 最后考虑1的影响
        return (ans*(2**dic[1]))%(10**9+7)  # 最终结果乘上1的可能组合数并取模</code></pre>
                        
                    </div>
                </section>
            
        </main>
    </div>
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.bundle.min.js"></script>
    <script src="/static/js/highlight.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const copyButtons = document.querySelectorAll('.copy-btn');
            copyButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    copyCode(this);
                });
            });
            hljs.highlightAll();
        });

        function copyCode(button) {
            const codeBlock = button.previousElementSibling;
            const code = codeBlock.textContent;
            navigator.clipboard.writeText(code).then(function() {
                button.textContent = '已复制';
                setTimeout(function() {
                    button.textContent = '复制代码';
                }, 2000);
            }, function(err) {
                console.error('无法复制代码: ', err);
            });
        }
    </script>
</body>
</html>