<!DOCTYPE html>
<html lang="zh">
<head>
    <title>两个有序数组的第 K 小乘积</title>
    <link rel="shortcut icon" href="/static/favicon.ico">
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/detail.css">
    <link rel="stylesheet" href="/static/css/github.css">
    <style>
        body {
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .container-fluid {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        main {
            flex-grow: 1;
        }
        .code-pre {
             white-space: pre-wrap;
             word-wrap: break-word;
        }
    </style>
</head>
<body>
    <div class="container-fluid mt-3">
        <header class="d-flex flex-column flex-md-row justify-content-md-between align-items-md-center mb-3">
            <a href="/problems" class="btn btn-secondary mb-2 mb-md-0">返回题目列表</a>
            <div class="text-md-end">
                <strong class="me-md-3 d-block d-md-inline mb-2 mb-md-0">两个有序数组的第 K 小乘积</strong>
                标签:
                
                    <a href="/problems?tag=array" class="badge bg-secondary tag-link">数组</a>
                
                    <a href="/problems?tag=binary-search" class="badge bg-secondary tag-link">二分查找</a>
                
                &nbsp;&nbsp;
                难度: <span class="badge bg-secondary">Hard</span>
            </div>
        </header>

        <main>
            <section class="mb-4">
                <h2>Submission</h2>
                <div class="code-block">
                    <pre class="bg-light p-2 code-pre"><code class="language-python">from numpy import array, sum

class Solution:
    def kthSmallestProduct(self, nums1: List[int], nums2: List[int], k: int) -&gt; int:
        nums1, nums2 = array(nums1), array(nums2)
        LEN2 = nums2.size
        above = nums1[nums1&gt;0]
        below = nums1[nums1&lt;0]
        zeroCount = sum(nums1 == 0)
        minmax = [nums1[0]*nums2[0], nums1[0]*nums2[-1], nums1[-1]*nums2[0], nums1[-1]*nums2[-1]]
        left, right = int(min(minmax)), int(max(minmax)+1)
        while (left &lt; right):
            n = (left+right)&gt;&gt;1
            if (sum(nums2.searchsorted(n/above)) + 
                LEN2*below.size-sum(nums2.searchsorted(n/below, &#34;right&#34;)) + 
                (zeroCount*LEN2 if n&gt;0 else 0)) &lt; k:
                left = n+1
            else:
                right = n
        return left-1

print(Solution().kthSmallestProduct([randint(1, 2*10**5) for i in range(2*10**5)], [randint(1, 2*10**5) for i in range(10**5)], 2*10**10))</code></pre>
                    <button class="btn btn-sm btn-secondary copy-btn" onclick="copyCode(this)">复制代码</button>
                    <p class="mt-2 mb-0">运行时间: 416 ms</p>
                    <p class="mb-0">内存: 44.3 MB</p>
                </div>
            </section>

            
                <section>
                    <h2>Explain</h2>
                    <div>
                        <p>The solution utilizes a binary search method on the product values rather than the indices of the arrays. Given two sorted arrays, the smallest and largest possible products are first identified. These products form the range for the binary search. The binary search&#39;s middle value is then used to count the products that are smaller than this middle value, by checking how many elements from nums2 are less than the division of this middle value by each element in nums1. This count determines if the k-th smallest product is greater or smaller than the middle value, adjusting the search range accordingly. The process continues until the exact k-th smallest product is located.</p>
                        <p>时间复杂度: O(log(maxProduct - minProduct) * log(len(nums2)) * len(nums1))</p>
                        <p>空间复杂度: O(len(nums1) + len(nums2))</p>
                        
                             <pre class="bg-light p-2 code-pre"><code class="language-python">from numpy import array, sum

class Solution:
    def kthSmallestProduct(self, nums1: List[int], nums2: List[int], k: int) -&gt; int:
        nums1, nums2 = array(nums1), array(nums2)  # Convert lists to numpy arrays
        LEN2 = nums2.size  # Length of the second array
        above = nums1[nums1 &gt; 0]  # Subarray of positive elements in nums1
        below = nums1[nums1 &lt; 0]  # Subarray of negative elements in nums1
        zeroCount = sum(nums1 == 0)  # Count of zeros in nums1
        # Calculate potential minimum and maximum products from boundary elements
        minmax = [nums1[0] * nums2[0], nums1[0] * nums2[-1], nums1[-1] * nums2[0], nums1[-1] * nums2[-1]]
        left, right = int(min(minmax)), int(max(minmax) + 1)  # Set initial binary search bounds
        while (left &lt; right):  # Binary search loop
            n = (left + right) &gt;&gt; 1  # Middle product value
            if (sum(nums2.searchsorted(n / above)) +  # Count of products less than &#39;n&#39; with positive nums1 elements
                LEN2 * below.size - sum(nums2.searchsorted(n / below, &#34;right&#34;)) +  # Adjust count for negative nums1 elements
                (zeroCount * LEN2 if n &gt; 0 else 0)) &lt; k:  # Include zero product counts if &#39;n&#39; allows
                left = n + 1  # Adjust search range
            else:
                right = n
        return left - 1  # Since left is incremented one past the correct answer</code></pre>
                        
                    </div>
                </section>
            
        </main>
    </div>
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.bundle.min.js"></script>
    <script src="/static/js/highlight.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const copyButtons = document.querySelectorAll('.copy-btn');
            copyButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    copyCode(this);
                });
            });
            hljs.highlightAll();
        });

        function copyCode(button) {
            const codeBlock = button.previousElementSibling;
            const code = codeBlock.textContent;
            navigator.clipboard.writeText(code).then(function() {
                button.textContent = '已复制';
                setTimeout(function() {
                    button.textContent = '复制代码';
                }, 2000);
            }, function(err) {
                console.error('无法复制代码: ', err);
            });
        }
    </script>
</body>
</html>