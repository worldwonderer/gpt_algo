<!DOCTYPE html>
<html lang="zh">
<head>
    <title>切分数组</title>
    <link rel="shortcut icon" href="/static/favicon.ico">
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/detail.css">
    <link rel="stylesheet" href="/static/css/github.css">
    <style>
        body {
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .container-fluid {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        main {
            flex-grow: 1;
        }
        .code-pre {
             white-space: pre-wrap;
             word-wrap: break-word;
        }
    </style>
</head>
<body>
    <div class="container-fluid mt-3">
        <header class="d-flex flex-column flex-md-row justify-content-md-between align-items-md-center mb-3">
            <a href="/problems" class="btn btn-secondary mb-2 mb-md-0">返回题目列表</a>
            <div class="text-md-end">
                <strong class="me-md-3 d-block d-md-inline mb-2 mb-md-0">切分数组</strong>
                标签:
                
                    <a href="/problems?tag=array" class="badge bg-secondary tag-link">数组</a>
                
                    <a href="/problems?tag=math" class="badge bg-secondary tag-link">数学</a>
                
                    <a href="/problems?tag=dynamic-programming" class="badge bg-secondary tag-link">动态规划</a>
                
                    <a href="/problems?tag=number-theory" class="badge bg-secondary tag-link">数论</a>
                
                &nbsp;&nbsp;
                难度: <span class="badge bg-secondary">Hard</span>
            </div>
        </header>

        <main>
            <section class="mb-4">
                <h2>Submission</h2>
                <div class="code-block">
                    <pre class="bg-light p-2 code-pre"><code class="language-python">M = 10 ** 6 + 1
np = [0] * M
pfs=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997] 
for p in pfs:
    for i in range(p*p,M,p):
        np[i]=p

class Solution:
    def splitArray(self, nums: List[int]) -&gt; int:
        f = {}
        pre = 0
        for i,x in enumerate(nums):
            cur = 100001
            while np[x]:    #如果还存在小于1000的质因素
                # p = np[x]   #当前质因素
                # while x % p == 0:
                    # x //= p
                
                f[np[x]] = min(f.get(np[x],100001),pre + 1)   #跳跃到fac这个因子，需要多少步 f[fac]。
                cur = min(cur,f[np[x]])
                x//=np[x]    
                
            if x&gt;1:  # 如果存在大于1000的质因素
                f[x] = min(f.get(x,100001),pre + 1)
                cur = min(cur,f[x])
            pre = cur
        return cur
</code></pre>
                    <button class="btn btn-sm btn-secondary copy-btn" onclick="copyCode(this)">复制代码</button>
                    <p class="mt-2 mb-0">运行时间: 361 ms</p>
                    <p class="mb-0">内存: 38.0 MB</p>
                </div>
            </section>

            
                <section>
                    <h2>Explain</h2>
                    <div>
                        <p>本题解采用动态规划的思想以及预处理的方法来解决问题。首先，通过一个预处理步骤，使用筛法计算每个数字的最小质因子。这个预处理步骤是基于一个修改版的埃拉托斯特尼筛法，只针对较小的质数。对于数组中的每个数字，我们使用预处理的结果来快速找到它的所有质因子，并且通过动态规划的方式计算如何分割数组以满足题目要求。动态规划的状态 f[p] 表示最后一个使用质数 p 作为头尾最大公约数的子数组所形成的最小切割数。对于每个数字 x，我们更新它的所有质因子对应的状态，然后找出最小的切割数作为当前位置的结果，并不断向前推进。</p>
                        <p>时间复杂度: O(n log x)</p>
                        <p>空间复杂度: O(M)</p>
                        
                             <pre class="bg-light p-2 code-pre"><code class="language-python">M = 10 ** 6 + 1
np = [0] * M
pfs=[2,3,5,7,...,997] # 列出了所有小于1000的质数
for p in pfs:
    for i in range(p*p, M, p):
        np[i]=p  # 使用修改的埃拉托斯特尼筛法计算最小质因子
class Solution:
    def splitArray(self, nums: List[int]) -&gt; int:
        f = {}  # 动态规划状态存储
        pre = 0  # 记录当前的最小切割数
        for i, x in enumerate(nums):
            cur = 100001  # 初始化当前位置的最小切割数
            while np[x]:  # 遍历 x 的所有质因子
                f[np[x]] = min(f.get(np[x], 100001), pre + 1)  # 更新使用当前质因子的最小切割数
                cur = min(cur, f[np[x]])  # 更新当前位置的最小切割数
                x //= np[x]  # 除去当前质因子
            if x &gt; 1:  # 如果 x 有大于1000的质因子
                f[x] = min(f.get(x, 100001), pre + 1)
                cur = min(cur, f[x])
            pre = cur  # 更新前一个位置的最小切割数
        return cur  # 返回最终的最小切割数</code></pre>
                        
                    </div>
                </section>
            
        </main>
    </div>
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.bundle.min.js"></script>
    <script src="/static/js/highlight.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const copyButtons = document.querySelectorAll('.copy-btn');
            copyButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    copyCode(this);
                });
            });
            hljs.highlightAll();
        });

        function copyCode(button) {
            const codeBlock = button.previousElementSibling;
            const code = codeBlock.textContent;
            navigator.clipboard.writeText(code).then(function() {
                button.textContent = '已复制';
                setTimeout(function() {
                    button.textContent = '复制代码';
                }, 2000);
            }, function(err) {
                console.error('无法复制代码: ', err);
            });
        }
    </script>
</body>
</html>